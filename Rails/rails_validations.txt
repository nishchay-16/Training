ACTIVE RECORD VALIDATIONS:-

Validations are used to ensure that only valid data is saved into your database. 
For example, it may be important to your application to ensure that every user provides a valid email address and mailing address.

class Librarian < ApplicationRecord
    validates :librarian_name, presence: true
end

irb> Librarian.create(librarian_name: "Nishchay").valid?
=> true
irb> Librarian.create(librarian_name: nil).valid?
=> false



WHY WE USE VALIDATIONS:-
1) Data Integrity:->  Validations ensure that only valid data is saved into the database. 
    For example, ensuring that email addresses are properly formatted or that required fields are not left blank.

2) Business Logic Enforcement:-> They help enforce business rules. 
    For instance, an e-commerce application might require that the quantity of items ordered cannot exceed the quantity in stock.

3) Preventing Invalid Data Entry:-> By validating data before saving it to the database, you can prevent invalid or corrupted data from being persisted. 
    This makes sure that your database contains only valid and meaningful data.

4) User Experience:-> Validations provide feedback to users. 
    If a user submits a form with invalid data, validations can generate error messages that inform the user what needs to be corrected.

5) Security:->  Validations can help prevent malicious data from being saved. 
    For example, validating input length and format can help prevent certain types of injection attacks.

6) Database Efficiency:-> By catching errors at the model level, you reduce the risk of encountering database errors, which can be more costly to handle. 
    This also helps in maintaining the consistency of the database.

7)Simplifies Code Maintenance:-> Centralizing validation logic within models makes the codebase easier to maintain and understand. 
    This keeps your controllers and views cleaner, adhering to the MVC architecture.



===>     VALIDATION HELPERS:-

1) acceptance -> This method validates that a checkbox on the user interface was checked when a form was submitted.



2) confirmation ->

--> validates :email, confirmation: true
    validates :email_confirmation, presence: true
Example:
3.3.0 :112 > a.email_confirmation="Naman@gmail.com"
 => "Naman@gmail.com" 
3.3.0 :113 > a.save
 => false 
3.3.0 :114 > a.save!
(irb):114:in `<main>': Validation failed: Email confirmation doesn't match Email (ActiveRecord::RecordInvalid)



3) comparison ->

--> :greater_than - Specifies the value must be greater than the supplied value. The default error message for this option is "must be greater than %{count}".
Example:
# validates :number_of_books, comparison: { greater_than: 0}
3.3.0 :035 > a = Librarian.find_by(email: 'n@g.com')
  Librarian Load (0.5ms)  SELECT "librarians".* FROM "librarians" WHERE "librarians"."email" = $1 LIMIT $2  [["email", "n@g.com"], ["LIMIT", 1]]
 => 
3.3.0 :036 > a.number_of_books=0
 => 0 
3.3.0 :037 > a.save
 => false 
3.3.0 :038 > a.save!
(irb):38:in `<main>': Validation failed: Number of books must be greater than 0 (ActiveRecord::RecordInvalid)


--> :greater_than_or_equal_to - Specifies the value must be greater than or equal to the supplied value. The default error message for this option is "must be greater than or equal to %{count}".
Example:
# validates :number_of_books, comparison: { greater_than_or_equal_to: 1}
3.3.0 :053 > a.number_of_books=0
 => 0 
3.3.0 :054 > a.save!
(irb):54:in `<main>': Validation failed: Number of books must be greater than or equal to 1 (ActiveRecord::RecordInvalid)


--> :equal_to - Specifies the value must be equal to the supplied value. The default error message for this option is "must be equal to %{count}".
Example:


:less_than - Specifies the value must be less than the supplied value. The default error message for this option is "must be less than %{count}".
Example:
# validates :number_of_books, comparison: { less_than: 1000}
3.3.0 :053 > a.number_of_books=1001
 => 1001
3.3.0 :054 > a.save!
(irb):54:in `<main>': Validation failed: Number of books must be less than 1000 (ActiveRecord::RecordInvalid)


:less_than_or_equal_to - Specifies the value must be less than or equal to the supplied value. The default error message for this option is "must be less than or equal to %{count}".
Example:
# validates :number_of_books, comparison: { less_than_or_equal_to: 1000}
3.3.0 :053 > a.number_of_books=1001
 => 1001
3.3.0 :054 > a.save!
(irb):54:in `<main>': Validation failed: Number of books must be less than or equal to 1000 (ActiveRecord::RecordInvalid)


:other_than - Specifies the value must be other than the supplied value. The default error message for this option is "must be other than %{count}".
Example:
# validates :number_of_books, comparison: { greater_than: 0, message: "must be greater than 0" }
3.3.0 :053 > a.number_of_books=0
 => 0 
3.3.0 :054 > a.save!
(irb):54:in `<main>': Validation failed: Number of books must be greater than 0 (ActiveRecord::RecordInvalid)



4) Format ->

# validates :librarian_name, format: { with: /\A[a-zA-Z]+\z/, message: "only allows letters" }
Example:
3.3.0 :061 > a.librarian_name="Nishchay1"
3.3.0 :062 > 
 => "Nishchay1" 
3.3.0 :063 > a.save!
(irb):63:in `<main>': Validation failed: Librarian name only allows letters (ActiveRecord::RecordInvalid)


# validates :librarian_name, format: { without: /\A[a-zA-Z]+\z/, message: "only allows numbers" }
Example:
3.3.0 :068 > a.librarian_name="Nishchay"
 => "Nishchay" 
3.3.0 :069 > a.save!
(irb):69:in `<main>': Validation failed: Librarian name only allows numbers (ActiveRecord::RecordInvalid



5) inclusion ->
This helper validates that the attributes' values are included in a given set. In fact, this set can be any enumerable object.

Example:
# validates :size, inclusion: { in: %w(small medium large),  message: "%{value} is not a valid size" }

3.3.0 :114 > a.size="full"
 => "full" 
3.3.0 :115 > a.save
 => false 
3.3.0 :116 > a.save!
(irb):116:in `<main>': Validation failed: Size full is not a valid size (ActiveRecord::RecordInvalid)

3.3.0 :117 > a.size="medium"
 => "medium" 
3.3.0 :118 > a.save
  TRANSACTION (0.4ms)  BEGIN
  Librarian Update (3.1ms)  UPDATE "librarians" SET "updated_at" = $1, "status" = $2, "size" = $3 WHERE "librarians"."id" = $4  [["updated_at", "2024-07-22 11:53:25.271387"], ["status", "full"], ["size", "medium"], ["id", 16]]
  TRANSACTION (1.2ms)  COMMIT
 => true 



6) exclusion ->
The opposite of inclusion is... exclusion!

Example:
# validates :status, exclusion: { in: ["active", "inactive"] }
3.3.0 :121 > a.status="active"
 => "active" 
3.3.0 :122 > a.save!
(irb):122:in `<main>': Validation failed: Status is reserved (ActiveRecord::RecordInvalid)



7) length ->
This helper validates the length of the attributes' values.
We can customize these messages using the :wrong_length, :too_long, and :too_short options and %{count} as a placeholder for the number corresponding to the length constraint being used.

Example:
# validates :librarian_name, length: { maximum: 10 }
3.3.0 :132 > a.librarian_name= "NishchayGupta"
 => "NishchayGupta" 
3.3.0 :133 > a.save!
(irb):133:in `<main>': Validation failed: Librarian name is too long (maximum is 10 characters) (ActiveRecord::RecordInvalid)


# validates :librarian_name, length: { is: 10 }
3.3.0 :145 > a.librarian_name= "Nishchay111"
 => "Nishchay111" 
3.3.0 :146 > a.save!
(irb):146:in `<main>': Validation failed: Librarian name is the wrong length (should be 10 characters) (ActiveRecord::RecordInvalid)


# validates :librarian_name, length: { minimum: 10 }
3.3.0 :136 > a.librarian_name= "NishchayGupta"
 => "NishchayGupta" 
3.3.0 :137 > a.save!
  TRANSACTION (0.4ms)  BEGIN
  Librarian Update (1.5ms)  UPDATE "librarians" SET "librarian_name" = $1, "updated_at" = $2 WHERE "librarians"."id" = $3  [["librarian_name", "NishchayGupta"], ["updated_at", "2024-07-22 12:15:18.399638"], ["id", 16]]
  TRANSACTION (2.0ms)  COMMIT
 => true 
3.3.0 :138 


# validates :librarian_name, length: { in: 10..20 }
3.3.0 :153 > a.librarian_name= "Nishchay"
 => "Nishchay" 
3.3.0 :154 > a.save!
(irb):154:in `<main>': Validation failed: Librarian name is too short (minimum is 10 characters) (ActiveRecord::RecordInvalid)

3.3.0 :155 > a.librarian_name= "Nishchay111111111111111111"
 => "Nishchay111111111111111111" 
3.3.0 :156 > a.save!
(irb):156:in `<main>': Validation failed: Librarian name is too long (maximum is 20 characters) (ActiveRecord::RecordInvalid)



8) numericality ->
This helper validates that your attributes have only numeric values. 
By default, it will match an optional sign followed by an integer or floating point number.
To specify that only integer numbers are allowed, set :only_integer to true. 
Then it will use the following regular expression to validate the attribute's value.

Example:
# validates :phone_no, numericality: true
3.3.0 :171 > a.phone_no="hi"
 => "hi" 
3.3.0 :172 > a.save!
(irb):172:in `<main>': Validation failed: Phone no is not a number (ActiveRecord::RecordInvalid)

# validates :phone_no, numericality: { only_integer: true }
3.3.0 :177 > a.phone_no="2.5"
 => "2.5" 
3.3.0 :178 > a.save!
(irb):178:in `<main>': Validation failed: Phone no must be an integer (ActiveRecord::RecordInvalid)
3.3.0 :179 > a.phone_no="9588169118"
 => "9588169118" 
3.3.0 :180 > a.save!
  TRANSACTION (0.4ms)  BEGIN
  Librarian Update (2.9ms)  UPDATE "librarians" SET "phone_no" = $1, "updated_at" = $2 WHERE "librarians"."id" = $3  [["phone_no", "9588169118"], ["updated_at", "2024-07-23 06:28:33.560115"], ["id", 16]]
  TRANSACTION (0.5ms)  COMMIT
 => true 

# validates :phone_no, numericality: { odd: true }
3.3.0 :186 > a.phone_no="12"
 => "12" 
3.3.0 :187 > a.save!
(irb):187:in `<main>': Validation failed: Phone no must be odd (ActiveRecord::RecordInvalid)

# validates :phone_no, numericality: { even: true }
3.3.0 :192 > a.phone_no="1"
 => "1" 
3.3.0 :193 > a.save!
(irb):193:in `<main>': Validation failed: Phone no must be even (ActiveRecord::RecordInvalid)



9) presence ->
This helper validates that the specified attributes are not empty. 

Example:
# validates :librarian_name, presence: true
3.3.0 :196 > a.librarian_name=""
 => "" 
3.3.0 :197 > a.save!
(irb):197:in `<main>': Validation failed: Librarian name can't be blank (ActiveRecord::RecordInvalid)

#  validates :librarian_name, presence: { message: 'must be present' }
3.3.0 :201 > a.librarian_name=""
 => "" 
3.3.0 :202 > a.save!
(irb):202:in `<main>': Validation failed: Librarian name must be present (ActiveRecord::RecordInvalid)



10) absence ->
This helper validates that the specified attributes are absent.

Example:
#  validates :librarian_name, absence: true
3.3.0 :205 > a.librarian_name="nishu"
 => "nishu" 
3.3.0 :206 > a.save!
(irb):206:in `<main>': Validation failed: Librarian name must be blank (ActiveRecord::RecordInvalid)



11) uniqueness ->
This helper validates that the attribute's value is unique right before the object gets saved.

Example:
# validates :phone_no , uniqueness: true
3.3.0 :227 > a.phone_no=12
 => 12 
3.3.0 :228 > a.save!
  TRANSACTION (0.3ms)  BEGIN
  Librarian Exists? (1.0ms)  SELECT 1 AS one FROM "librarians" WHERE "librarians"."phone_no" = $1 AND "librarians"."id" != $2 LIMIT $3  [["phone_no", "12"], ["id", 14], ["LIMIT", 1]]
  TRANSACTION (0.2ms)  ROLLBACK
(irb):228:in `<main>': Validation failed: Phone no has already been taken (ActiveRecord::RecordInvalid)